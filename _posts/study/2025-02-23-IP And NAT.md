---
title: IP 주소체계와 서브네팅, NAT
date: 2025-02-23 00:11:00 +09:00
categories: [common_topic]
tags: [common]
# image: 
#   path:
---


### 1.1. IP 주소 관리의 중요성

현대 네트워크는 우리의 일상생활과 업무 환경에 깊숙이 침투해 있습니다. 인터넷, 기업 네트워크, 클라우드 서비스 등 다양한 네트워크 환경에서 데이터 통신이 원활하게 이루어지기 위해서는 효율적인 IP 주소 관리가 필수적입니다. IP 주소는 네트워크 상의 장치를 식별하고 통신 경로를 설정하는 데 핵심적인 역할을 수행하며, 그 중요성은 날이 갈수록 증가하고 있습니다.

### 1.1.1. 현대 네트워크 환경에서의 IP 주소 관리의 필수성

오늘날 네트워크에 연결되는 장치 수는 폭발적으로 증가하고 있습니다. 스마트폰, 태블릿, IoT 기기 등 다양한 장비들이 네트워크에 연결되면서 IP 주소 수요는 급증하고 있으며, IPv4 주소 고갈 문제는 더욱 심각해지고 있습니다. 이러한 상황에서 제한된 IP 주소 자원을 효율적으로 관리하고 활용하는 것은 네트워크 운영의 핵심 과제가 되었습니다.

### 1.1.2. 효율적인 IP 주소 관리의 필요성: 서브네팅과 NAT의 역할

효율적인 IP 주소 관리는 단순히 주소를 할당하고 회수하는 것을 넘어, 네트워크 성능 향상, 보안 강화, 관리 효율성 증대 등 다양한 측면에서 중요한 의미를 가집니다. **서브네팅(Subnetting)**은 하나의 네트워크를 여러 개의 작은 네트워크로 분할하여 주소 공간을 효율적으로 사용하는 기술이며, **NAT(Network Address Translation)**는 사설 IP 주소를 공인 IP 주소로 변환하여 공인 IP 주소 부족 문제를 완화하고 내부 네트워크를 보호하는 기술입니다. 이 두 기술은 현대 네트워크 환경에서 효율적인 IP 주소 관리를 위한 핵심적인 역할을 담당합니다.

### 1.1.3. 보안 및 네트워크 설계에 있어서의 IP 주소 관리의 중요성

IP 주소 관리는 네트워크 보안과 설계에도 큰 영향을 미칩니다. 서브네팅을 통해 네트워크를 기능별, 보안 레벨별로 분리하여 관리함으로써, 네트워크 보안을 강화하고 특정 영역으로의 공격 확산을 방지할 수 있습니다. 또한, NAT는 내부 네트워크 구조를 숨겨 외부로부터의 직접적인 공격을 차단하는 효과를 제공합니다. 효율적인 IP 주소 관리는 네트워크 설계 단계에서부터 고려되어야 하며, 네트워크의 확장성, 유연성, 보안성을 확보하는 데 중요한 기반이 됩니다.

## **2. IP 주소체계**

### 2.1. IP 주소의 개념 및 역할

### 2.1.1. IP 주소 정의 및 기능

- **IP 주소(Internet Protocol Address)**는 인터넷 프로토콜(IP) 네트워크에서 장치를 식별하고 위치를 찾기 위해 사용되는 논리적인 주소입니다. 마치 현실 세계의 우편 주소나 전화번호와 같이, 네트워크 상의 각 장치는 고유한 IP 주소를 가져야 다른 장치와 통신할 수 있습니다. IP 주소는 데이터를 목적지까지 정확하게 전달하는 데 필수적인 역할을 합니다.

### 2.1.2. 공인 IP 주소와 사설 IP 주소

IP 주소는 크게 **공인 IP 주소(Public IP Address)**와 **사설 IP 주소(Private IP Address)**로 구분됩니다.

- **공인 IP 주소:** 인터넷 서비스 제공자(ISP)로부터 할당받아 인터넷에 직접 연결된 장치들이 사용하는 주소입니다. 전 세계적으로 유일하며, 인터넷 상에서 다른 장치와 통신하기 위해 반드시 필요합니다. 웹 서버, 메일 서버 등 외부에서 접근해야 하는 서버들은 공인 IP 주소를 사용합니다.
- **사설 IP 주소:** 일반 가정이나 기업의 내부 네트워크에서 사용되는 주소입니다. 인터넷 주소 관리 기구에서 특정 대역을 사설 IP 주소로 예약해두었으며, 이 대역 내의 주소는 자유롭게 사용할 수 있습니다. 사설 IP 주소는 인터넷에서 직접적으로 통신할 수 없으며, **NAT**와 같은 기술을 통해 공인 IP 주소로 변환되어 인터넷에 접속합니다.

### 2.2. IPv4 주소체계

### 2.2.1. IPv4 주소 구조 및 클래스

- **IPv4(Internet Protocol version 4)**는 32비트 주소 체계로, 약 43억 개의 주소를 표현할 수 있습니다. IPv4 주소는 일반적으로 **점으로 구분된 10진수 표기법(dotted decimal notation)**으로 표현되며, 8비트씩 4개의 옥텟으로 나뉘어 점(.)으로 구분됩니다. 예를 들어, `192.168.1.1`과 같은 형태입니다.

초기 IPv4 주소체계는 **클래스 기반 주소체계**를 사용했습니다. 이는 IP 주소를 네트워크 크기에 따라 A, B, C, D, E 5개의 클래스로 분류하는 방식입니다. 각 클래스는 네트워크 ID와 호스트 ID의 비트 수 할당이 다르게 정의되어 있습니다.

- **A 클래스:** 대규모 네트워크 (예: 국가 기관, 대기업) 에 적합하며, 네트워크 ID 8비트, 호스트 ID 24비트로 구성됩니다. 첫 번째 옥텟의 범위는 1~126입니다.
- **B 클래스:** 중규모 네트워크 (예: 중견 기업, 대학교) 에 적합하며, 네트워크 ID 16비트, 호스트 ID 16비트로 구성됩니다. 첫 번째 옥텟의 범위는 128~191입니다.
- **C 클래스:** 소규모 네트워크 (예: 소규모 사업장, 가정) 에 적합하며, 네트워크 ID 24비트, 호스트 ID 8비트로 구성됩니다. 첫 번째 옥텟의 범위는 192~223입니다.
- **D 클래스:** 멀티캐스트 용도로 사용되며, 첫 번째 옥텟의 범위는 224~239입니다.
- **E 클래스:** 예약된 주소이며, 첫 번째 옥텟의 범위는 240~255입니다.

하지만 클래스 기반 주소체계는 주소 할당의 유연성이 떨어지고 주소 낭비가 심하다는 문제점이 있었습니다. 예를 들어, C 클래스는 호스트 수가 254개로 제한되어 소규모 네트워크에는 적합하지만, 조금 더 큰 규모의 네트워크에는 부족하고 B 클래스를 할당받기에는 너무 커서 주소 낭비가 발생했습니다.

### 2.2.2. 클래스리스 주소체계 (CIDR)

이러한 클래스 기반 주소체계의 한계를 극복하기 위해 **클래스리스 주소체계(Classless Inter-Domain Routing, CIDR)**가 도입되었습니다. CIDR은 주소 클래스 개념을 없애고 네트워크 ID의 길이를 가변적으로 할당하는 방식입니다. CIDR 표기법은 IP 주소 뒤에 슬래시(/)와 함께 네트워크 ID 비트 수를 표기합니다. 예를 들어, `192.168.1.0/24`는 네트워크 ID가 24비트임을 의미하며, 나머지 8비트가 호스트 ID로 사용됩니다. CIDR을 통해 네트워크 관리자는 네트워크 규모에 맞춰 주소를 효율적으로 할당하고 낭비를 줄일 수 있게 되었습니다.

### 2.2.3. 공인 IP 주소와 사설 IP 주소 (재언급)

앞서 간략히 설명했듯이, 공인 IP 주소와 사설 IP 주소는 IPv4 주소체계에서 중요한 구분입니다.

- **공인 IP 주소:** 인터넷에 직접 연결되는 장치에 할당되며, 전 세계적으로 유일해야 합니다. 공인 IP 주소는 인터넷 주소 관리 기관(IANA)과 지역 인터넷 레지스트리(RIR)를 통해 관리 및 할당됩니다.
- **사설 IP 주소:** 내부 네트워크에서 자유롭게 사용할 수 있도록 예약된 주소 대역입니다. RFC 1918 문서에 사설 IP 주소 대역이 정의되어 있으며, 일반적으로 다음과 같은 대역이 사용됩니다.
    - 10.0.0.0 ~ 10.255.255.255 (10/8 prefix)
    - 172.16.0.0 ~ 172.31.255.255 (172.16/12 prefix)
    - 192.168.0.0 ~ 192.168.255.255 (192.168/16 prefix)

사설 IP 주소는 인터넷에서 직접 라우팅되지 않으며, NAT와 같은 기술을 통해 공인 IP 주소로 변환되어 인터넷에 접속해야 합니다. 사설 IP 주소를 사용함으로써 공인 IP 주소 부족 문제를 완화하고 내부 네트워크 보안을 강화할 수 있습니다.

### 2.2.4. 특수 용도 IP 주소

IPv4 주소 중에는 특수한 용도로 예약된 주소들이 있습니다.

- **루프백 주소 (Loopback Address):** `127.0.0.0/8` 대역은 루프백 주소로 예약되어 있으며, 주로 자기 자신을 가리키는 데 사용됩니다. `127.0.0.1`은 대표적인 루프백 주소이며, 네트워크 인터페이스가 정상적으로 작동하는지 확인하는 데 사용됩니다. `ping 127.0.0.1` 명령어를 통해 자신의 네트워크 인터페이스를 테스트할 수 있습니다.
- **브로드캐스트 주소 (Broadcast Address):** 브로드캐스트 주소는 네트워크 내의 모든 장치에게 데이터를 전송하는 데 사용됩니다. IPv4 브로드캐스트 주소는 크게 **네트워크 브로드캐스트 주소**와 **로컬 브로드캐스트 주소**로 나뉩니다. 네트워크 브로드캐스트 주소는 특정 네트워크의 마지막 주소이며 (예: 192.168.1.255/24 네트워크의 브로드캐스트 주소), 로컬 브로드캐스트 주소는 `255.255.255.255`입니다. 로컬 브로드캐스트 주소는 현재 네트워크 세그먼트에만 브로드캐스트됩니다.
- **멀티캐스트 주소 (Multicast Address):** 멀티캐스트 주소는 특정 그룹의 장치들에게 데이터를 동시에 전송하는 데 사용됩니다. IPv4 멀티캐스트 주소는 D 클래스 주소 대역 (224.0.0.0 ~ 239.255.255.255) 에 할당되어 있습니다. 멀티캐스트는 비디오 스트리밍, 화상 회의 등 특정 그룹에게 데이터를 효율적으로 전송해야 하는 애플리케이션에 유용하게 사용됩니다.

### 2.3. IPv6 주소체계

### 2.3.1. IPv6 필요성 및 특징

- **IPv6(Internet Protocol version 6)**는 IPv4 주소 부족 문제를 해결하기 위해 개발된 차세대 IP 주소 체계입니다. IPv4의 32비트 주소 공간으로는 급증하는 IP 주소 수요를 감당하기 어려워졌고, IPv6는 128비트 주소 공간을 제공하여 사실상 무한대에 가까운 주소를 할당할 수 있게 되었습니다.

### 2.3.2. IPv6 주소 구조 및 유형

IPv6 주소는 128비트로 구성되며, **16진수 콜론 표기법(hexadecimal colon notation)**으로 표현됩니다. 16비트씩 8개의 섹션으로 나뉘어 콜론(:)으로 구분됩니다. 예를 들어, `2001:0db8:85a3:0000:0000:8a2e:0370:7334`와 같은 형태입니다. IPv6 주소 표기법은 다음과 같은 규칙에 따라 간략하게 표현할 수 있습니다.

- 각 섹션의 앞부분에 있는 0은 생략할 수 있습니다 (예: `0000`은 `0`으로, `0db8`은 `db8`로 줄여 쓸 수 있습니다).
- 연속되는 0으로 이루어진 섹션들은 콜론 두 개(:)로 축약하여 표현할 수 있습니다. 단, 한 번만 사용할 수 있습니다. (예: `2001:0db8:85a3:0:0:8a2e:0370:7334`는 `2001:db8:85a3::8a2e:370:7334`로 줄여 쓸 수 있습니다).

IPv6 주소는 주소 유형에 따라 **유니캐스트(Unicast), 멀티캐스트(Multicast), 애니캐스트(Anycast)** 세 가지로 분류됩니다.

- **유니캐스트 주소:** 특정 장치 하나를 식별하는 주소이며, 한 장치에서 다른 장치로 일대일 통신을 할 때 사용됩니다.
- **멀티캐스트 주소:** 특정 그룹의 장치들을 식별하는 주소이며, 한 장치에서 여러 장치로 데이터를 동시에 전송할 때 사용됩니다.
- **애니캐스트 주소:** 특정 그룹의 장치들 중 가장 가까운 장치 하나를 식별하는 주소이며, 한 장치에서 가장 가까운 서버로 데이터를 전송할 때 사용됩니다.

IPv6 주소는 **프리픽스(prefix)**와 **인터페이스 ID**로 구성됩니다. 프리픽스는 네트워크를 식별하는 부분이며, 인터페이스 ID는 네트워크 내에서 호스트를 식별하는 부분입니다. IPv6 주소는 자동 설정 기능을 통해 장치가 스스로 주소를 할당받을 수 있으며, 보안 기능 및 확장된 헤더 구조를 1  통해 IPv4에 비해 향상된 기능을 제공합니다.

### 2.3.3. IPv4 vs IPv6 비교

| 특징 | IPv4 | IPv6 |
| --- | --- | --- |
| 주소 공간 | 32비트 (약 43억 개) | 128비트 (사실상 무한대) |
| 주소 표기 | 점으로 구분된 10진수 | 16진수 콜론 표기 |
| 주소 클래스 | 클래스 기반 (A, B, C, D, E) | 클래스리스 |
| 헤더 크기 | 가변 (최소 20바이트) | 고정 (40바이트) |
| 주소 자동 설정 | 수동 또는 DHCP | 주소 자동 설정 (Stateless Address Autoconfiguration, SLAAC), DHCPv6 |
| 보안 | IPsec 옵션 | IPsec 기본 내장 |
| 이동성 | Mobile IPv4 | Mobile IPv6 |
| 확장성 | 제한적 | 우수 |

IPv6는 IPv4의 주소 부족 문제를 해결하고, 보안 및 성능 면에서 향상된 기능을 제공하지만, IPv4와 완벽하게 호환되지 않기 때문에 IPv4에서 IPv6로의 점진적인 전환이 필요합니다. IPv4에서 IPv6로의 전환 전략으로는 **듀얼 스택(Dual Stack), 터널링(Tunneling), 변환(Translation)** 기술 등이 사용됩니다. 듀얼 스택은 IPv4와 IPv6를 동시에 지원하는 방식이며, 터널링은 IPv6 패킷을 IPv4 네트워크를 통해 전송하는 방식, 변환은 IPv6와 IPv4 주소 및 프로토콜을 서로 변환하는 방식입니다.

## **3. 서브네팅 (Subnetting)**

### 3.1. 서브네팅 개념 및 필요성

### 3.1.1. 서브네팅 정의 및 목적

- 서브네팅(Subnetting)은 하나의 IP 네트워크를 여러 개의 더 작은 네트워크, 즉 서브넷(Subnet)으로 분할하는 기술입니다. 서브네팅은 네트워크 주소의 호스트 ID 부분을 서브넷 ID로 사용하여 네트워크를 논리적으로 분할합니다. 서브네팅을 통해 네트워크 관리자는 IP 주소 공간을 효율적으로 관리하고, 네트워크를 유연하게 구성할 수 있습니다.

### 3.1.2. 서브네팅 필요성

서브네팅은 다음과 같은 주요 필요성에 의해 도입되었습니다.

- **주소 공간 효율성 향상:** 클래스 기반 주소체계의 주소 낭비 문제를 해결하고, 네트워크 규모에 맞춰 주소를 효율적으로 할당할 수 있습니다. CIDR과 함께 서브네팅은 주소 낭비를 최소화하고 주소 활용도를 극대화하는 데 기여합니다.
- **네트워크 관리 용이성 증대:** 네트워크를 서브넷으로 분할하여 관리함으로써, 네트워크 구성 및 관리가 더욱 효율적으로 이루어질 수 있습니다. 서브넷별로 관리 정책을 적용하고 문제를 격리하는 것이 용이해집니다.
- **브로드캐스트 트래픽 감소:** 네트워크를 서브넷으로 분할하면 브로드캐스트 도메인이 축소되어 불필요한 브로드캐스트 트래픽을 감소시키고 네트워크 성능을 향상시킬 수 있습니다. 브로드캐스트 트래픽 감소는 네트워크 혼잡을 줄이고 데이터 전송 효율을 높이는 데 중요한 역할을 합니다.

### 3.2. 서브넷 마스크

### 3.2.1. 서브넷 마스크 역할 및 표기법

- 서브넷 마스크(Subnet Mask)는 IP 주소와 함께 사용되어 IP 주소의 네트워크 ID 부분과 호스트 ID 부분을 구분하는 역할을 합니다. 서브넷 마스크는 IP 주소와 마찬가지로 32비트 또는 128비트(IPv6)로 구성되며, 네트워크 ID 부분은 2진수 '1'로, 호스트 ID 부분은 2진수 '0'으로 채워져 있습니다.

서브넷 마스크 표기법은 IP 주소 표기법과 유사하게 **점으로 구분된 10진수 표기법**을 사용하거나, CIDR 표기법 (/prefix)을 사용합니다. 예를 들어, 서브넷 마스크 `255.255.255.0`은 CIDR 표기법으로 `/24`로 표현됩니다. 이는 네트워크 ID가 24비트임을 의미합니다.

### 3.2.2. 서브넷 생성 원리

서브네팅은 서브넷 마스크를 조작하여 서브넷 ID 비트를 늘리고 호스트 ID 비트를 줄이는 방식으로 서브넷을 생성합니다. 서브넷 마스크에서 '1'로 설정된 비트 수가 늘어날수록 서브넷 개수는 증가하지만, 각 서브넷에 할당할 수 있는 호스트 수는 감소합니다. 서브넷 마스크를 통해 네트워크를 얼마나 세분화할 것인지, 각 서브넷에 얼마나 많은 호스트를 수용할 것인지 결정할 수 있습니다.

### 3.3. 서브네팅 계산

### 3.3.1. 서브넷/호스트 개수 계산

서브네팅을 위해서는 필요한 서브넷 개수와 각 서브넷에 필요한 호스트 개수를 먼저 결정해야 합니다. 그 후, 서브넷 마스크를 결정하고 서브넷 주소 범위를 계산합니다.

- **필요한 서브넷 개수 및 호스트 개수 결정:** 네트워크 설계 요구사항에 따라 필요한 서브넷 개수와 각 서브넷에 수용해야 하는 호스트 개수를 파악합니다. 예를 들어, 부서별로 서브넷을 분리하고 각 부서에 필요한 호스트 수를 고려하여 서브넷 개수를 결정합니다.
- **서브넷 마스크 결정 방법 (비트 borrowing):** 필요한 서브넷 개수를 충족하기 위해 호스트 ID 비트 중에서 몇 비트를 서브넷 ID 비트로 빌려올지 결정합니다. 빌려온 비트 수를 'n'이라고 하면, 생성 가능한 서브넷 개수는 2<sup>n</sup>개입니다. 예를 들어, 2비트를 빌려오면 4개의 서브넷을 생성할 수 있습니다. 서브넷 마스크는 빌려온 비트 수만큼 네트워크 ID 비트 수를 늘려 설정합니다.
- **서브넷 개수, 호스트 개수, 서브넷 마스크 간의 관계 공식:**
    - 서브넷 개수 = 2<sup>(빌려온 비트 수)</sup>
    - 서브넷 당 호스트 개수 = 2<sup>(남은 호스트 ID 비트 수)</sup> - 2 (네트워크 주소와 브로드캐스트 주소 제외)
    - 서브넷 마스크: 네트워크 ID 비트 수와 서브넷 ID 비트 수를 '1'로 설정

### 3.3.2. 서브넷 주소 범위 계산

서브네팅 계산의 핵심은 각 서브넷의 네트워크 주소, 브로드캐스트 주소, 사용 가능한 호스트 주소 범위를 정확하게 계산하는 것입니다.

- **네트워크 주소, 브로드캐스트 주소, 사용 가능한 호스트 주소 범위 계산 예시:**
    - 예를 들어, `192.168.1.0/24` 네트워크를 4개의 서브넷으로 분할하는 경우 (2비트 borrowing)
    - 서브넷 마스크: `/26` (24 + 2 = 26) 또는 `255.255.255.192` (`11111111.11111111.11111111.11000000`)
    - 서브넷 1:
        - 네트워크 주소: `192.168.1.0`
        - 브로드캐스트 주소: `192.168.1.63`
        - 사용 가능 호스트 주소 범위: `192.168.1.1` ~ `192.168.1.62`
    - 서브넷 2:
        - 네트워크 주소: `192.168.1.64`
        - 브로드캐스트 주소: `192.168.1.127`
        - 사용 가능 호스트 주소 범위: `192.168.1.65` ~ `192.168.1.126`
    - 서브넷 3:
        - 네트워크 주소: `192.168.1.128`
        - 브로드캐스트 주소: `192.168.1.191`
        - 사용 가능 호스트 주소 범위: `192.168.1.129` ~ `192.168.1.190`
    - 서브넷 4:
        - 네트워크 주소: `192.168.1.192`
        - 브로드캐스트 주소: `192.168.1.255`
        - 사용 가능 호스트 주소 범위: `192.168.1.193` ~ `192.168.1.254`

### 3.4. CIDR (Classless Inter-Domain Routing)

### 3.4.1. CIDR 개념 및 VLSM

- CIDR(Classless Inter-Domain Routing)은 클래스 기반 주소체계의 한계를 극복하고 주소 낭비를 줄이기 위해 도입된 기술입니다. CIDR은 서브네팅 개념을 확장하여 네트워크 주소 할당의 유연성을 극대화합니다. CIDR 표기법은 IP 주소 뒤에 슬래시(/)와 함께 네트워크 프리픽스 길이 (네트워크 ID 비트 수) 를 표기하며, 네트워크 크기를 자유롭게 지정할 수 있도록 합니다.
- VLSM(Variable Length Subnet Mask, 가변 길이 서브넷 마스크)는 CIDR 환경에서 서브네팅을 더욱 효율적으로 활용하기 위한 기술입니다. VLSM을 사용하면 네트워크를 필요에 따라 다양한 크기의 서브넷으로 분할할 수 있습니다. 예를 들어, 어떤 서브넷에는 많은 호스트가 필요하고, 어떤 서브넷에는 적은 호스트만 필요한 경우, VLSM을 통해 각 서브넷에 필요한 만큼의 주소 공간을 할당하여 주소 낭비를 최소화할 수 있습니다.

### 3.4.2. CIDR 표기법의 장점 및 서브네팅 활용 확장

CIDR 표기법은 클래스 기반 주소체계에 비해 다음과 같은 장점을 가집니다.

- **주소 할당 효율성 증대:** 네트워크 크기에 맞춰 주소를 유연하게 할당하여 주소 낭비를 줄일 수 있습니다.
- **라우팅 테이블 크기 감소:** CIDR을 사용하면 라우팅 정보를 더 효율적으로 집약할 수 있어 라우팅 테이블 크기를 줄이고 라우팅 성능을 향상시킬 수 있습니다.
- **서브네팅 설계 유연성 증대:** VLSM과 함께 사용하면 네트워크를 다양한 크기의 서브넷으로 분할하여 네트워크 설계의 유연성을 높일 수 있습니다.

### 3.5. 서브네팅 장단점

### 3.5.1. 서브네팅 장점

- **주소 효율성:** IP 주소 공간을 효율적으로 사용하여 주소 낭비를 줄이고 주소 활용도를 극대화합니다.
- **네트워크 관리 효율성:** 네트워크를 서브넷으로 분할하여 관리함으로써, 네트워크 구성 및 관리가 효율적으로 이루어집니다. 서브넷별 관리 정책 적용 및 문제 격리가 용이합니다.
- **보안 강화:** 네트워크를 서브넷으로 분리하여 보안 경계를 설정하고, 특정 서브넷으로의 공격 확산을 방지하여 네트워크 보안을 강화할 수 있습니다.

### 3.5.2. 서브네팅 단점

- **설계 복잡성 증가:** 서브네팅 설계는 네트워크 규모, 트래픽 패턴, 보안 요구사항 등을 고려해야 하므로 복잡성이 증가할 수 있습니다. 정확한 서브네팅 설계를 위해서는 충분한 지식과 경험이 필요합니다.
- **주소 낭비 가능성 (VLSM으로 극복 가능):** 서브네팅을 잘못 설계하면 오히려 주소 낭비가 발생할 수 있습니다. 하지만 VLSM을 사용하여 가변 길이 서브넷 마스크를 적용하면 주소 낭비 문제를 최소화할 수 있습니다.

**4. NAT (Network Address Translation)**

### 4.1. NAT 개념 및 필요성

### 4.1.1. NAT 정의 및 필요성

- NAT(Network Address Translation, 네트워크 주소 변환)는 사설 IP 주소를 공인 IP 주소로 변환하는 기술입니다. NAT는 주로 IPv4 환경에서 공인 IP 주소 부족 문제를 해결하고, 내부 네트워크를 외부로부터 보호하기 위해 사용됩니다. NAT 장비 (라우터, 방화벽 등) 는 내부 네트워크에서 외부 네트워크로 나가는 패킷의 출발지 IP 주소를 공인 IP 주소로 변환하고, 외부 네트워크에서 내부 네트워크로 들어오는 패킷의 목적지 IP 주소를 사설 IP 주소로 변환하는 역할을 수행합니다.

### 4.1.2. NAT 필요성: 공인 IP 주소 부족 문제 해결의 핵심 기술

IPv4 주소 고갈 문제는 NAT 기술 도입의 가장 큰 이유입니다. 전 세계적으로 IPv4 주소가 부족해지면서 모든 장치에 공인 IP 주소를 할당하는 것이 불가능해졌습니다. NAT를 사용하면 하나의 공인 IP 주소를 여러 개의 사설 IP 주소를 사용하는 장치들이 공유하여 인터넷에 접속할 수 있게 됩니다. 특히 가정이나 기업의 내부 네트워크에서는 수많은 장치가 사설 IP 주소를 사용하고 NAT를 통해 인터넷에 접속하는 것이 일반적입니다.

### 4.1.3. 보안 강화 효과: 내부 네트워크 구조 숨김 및 외부 공격 방어

NAT는 단순히 주소 변환 기능뿐만 아니라, 내부 네트워크 보안을 강화하는 효과도 제공합니다. NAT를 사용하면 내부 네트워크의 실제 IP 주소체계가 외부 네트워크에 노출되지 않아 외부 공격자가 내부 네트워크 구조를 파악하기 어렵게 됩니다. 또한, NAT는 기본적으로 외부에서 내부 네트워크로의 연결을 차단하는 방화벽 기능도 제공하여 외부로부터의 직접적인 공격을 방어하는 역할을 합니다.

### 4.2. NAT 동작 방식

### 4.2.1. NAT 주소 변환 과정 상세 설명

NAT는 출발지 주소 및 포트 변환을 통해 주소 변환을 수행합니다. 내부 네트워크 장치가 외부 네트워크로 패킷을 전송할 때, NAT 장비는 다음과 같은 변환 과정을 거칩니다.

1. **출발지 사설 IP 주소를 NAT 장비의 공인 IP 주소로 변환:** 내부 장치의 사설 IP 주소가 NAT 장비에 설정된 공인 IP 주소로 변경됩니다.
2. **출발지 포트 번호를 NAT 장비의 임시 포트 번호로 변환:** 출발지 포트 번호는 NAT 장비가 관리하는 임시 포트 번호로 변경됩니다. 이때, NAT 장비는 변환 정보를 NAT 테이블에 기록합니다.
3. **변환된 패킷을 외부 네트워크로 전송:** 변환된 패킷은 공인 IP 주소와 임시 포트 번호를 출발지 주소 및 포트 정보로 사용하여 외부 네트워크로 전송됩니다.

외부 네트워크에서 내부 네트워크로 응답 패킷이 돌아올 때, NAT 장비는 NAT 테이블을 참조하여 다음과 같은 역변환 과정을 거칩니다.

1. **목적지 공인 IP 주소를 NAT 장비의 공인 IP 주소로 확인:** 응답 패킷의 목적지 IP 주소가 NAT 장비의 공인 IP 주소와 일치하는지 확인합니다.
2. **목적지 포트 번호를 NAT 테이블에서 매칭되는 임시 포트 번호로 확인:** 응답 패킷의 목적지 포트 번호가 NAT 테이블에 기록된 임시 포트 번호와 일치하는지 확인합니다.
3. **NAT 테이블에서 매칭되는 사설 IP 주소 및 포트 번호 확인:** 일치하는 임시 포트 번호에 매핑된 사설 IP 주소와 원래 포트 번호를 NAT 테이블에서 찾습니다.
4. **목적지 IP 주소와 포트 번호를 사설 IP 주소와 원래 포트 번호로 변환:** 응답 패킷의 목적지 IP 주소와 포트 번호를 NAT 테이블에서 찾은 사설 IP 주소와 원래 포트 번호로 변환합니다.
5. **변환된 패킷을 내부 네트워크로 전송:** 변환된 패킷은 사설 IP 주소와 원래 포트 번호를 목적지 주소 및 포트 정보로 사용하여 내부 네트워크로 전송됩니다.

### 4.2.2. NAT 테이블 (변환 테이블)

- NAT 테이블(Translation Table)은 NAT 장비가 주소 변환 정보를 저장하고 관리하는 테이블입니다. NAT 테이블은 다음과 같은 정보들을 저장합니다.
- **내부 IP 주소:** 사설 네트워크 장치의 IP 주소
- **내부 포트 번호:** 사설 네트워크 장치가 사용한 포트 번호
- **공인 IP 주소:** NAT 장비의 공인 IP 주소
- **공인 포트 번호:** NAT 장비가 할당한 임시 포트 번호
- **프로토콜:** TCP, UDP 등 프로토콜 유형
- **타임아웃:** NAT 테이블 항목 유지 시간

NAT 테이블은 NAT 장비가 주소 변환을 정확하게 수행하고, 외부에서 들어오는 응답 패킷을 내부 장치에게 정확하게 전달하는 데 핵심적인 역할을 합니다. NAT 테이블의 항목은 일정 시간 동안 사용되지 않으면 자동으로 삭제되어 NAT 테이블의 크기를 효율적으로 관리합니다.

### 4.3. NAT 유형

NAT는 동작 방식에 따라 여러 유형으로 분류됩니다.

### 4.3.1. Static NAT (정적 NAT)

- Static NAT(정적 NAT)는 사설 IP 주소와 공인 IP 주소를 1:1로 고정 매핑하는 방식입니다. 특정 사설 IP 주소에 항상 동일한 공인 IP 주소를 할당하며, 외부에서 특정 공인 IP 주소로 접속하면 항상 특정 사설 IP 주소로 연결됩니다. Static NAT는 주로 웹 서버, 메일 서버 등 외부에서 항상 접근해야 하는 서버를 운영할 때 사용됩니다.
- **장점:** 외부에서 내부 서버로의 지속적인 접근이 가능합니다.
- **단점:** 1:1 매핑으로 인해 공인 IP 주소 낭비가 발생하며, 동적으로 주소를 할당할 수 없습니다.

### 4.3.2. Dynamic NAT (동적 NAT)

- Dynamic NAT(동적 NAT)는 사설 IP 주소와 공인 IP 주소를 N:M으로 동적 매핑하는 방식입니다. 미리 설정된 공인 IP 주소 풀에서 IP 주소를 동적으로 할당하며, 사용 가능한 공인 IP 주소가 없을 경우 새로운 연결을 허용하지 않습니다. Dynamic NAT는 일반적으로 기업 환경에서 내부 직원들이 인터넷에 접속할 때 사용됩니다.
- **장점:** 공인 IP 주소를 효율적으로 사용할 수 있습니다.
- **단점:** 외부에서 내부 네트워크로의 직접적인 접속이 어렵고, 동시 접속 사용자 수가 공인 IP 주소 풀 크기에 의해 제한될 수 있습니다.

### 4.3.3. PAT/NAPT (Port Address Translation / Network Address Port Translation, 포트-다중 NAT)

- PAT/NAPT(Port Address Translation/Network Address Port Translation, 포트-다중 NAT)는 하나의 공인 IP 주소를 여러 개의 사설 IP 주소를 사용하는 장치들이 공유하여 인터넷에 접속할 수 있도록 하는 방식입니다. PAT/NAPT는 IP 주소뿐만 아니라 포트 번호까지 변환하여 1:N 매핑을 구현합니다. 대부분의 가정용 공유기나 소규모 사무실에서 사용하는 NAT 방식이 PAT/NAPT이며, IP 주소 부족 문제를 해결하는 데 매우 효과적인 기술입니다.
- **장점:** 공인 IP 주소를 매우 효율적으로 사용할 수 있으며, 다수의 내부 장치가 하나의 공인 IP 주소를 공유하여 인터넷에 접속할 수 있습니다.
- **단점:** 외부에서 내부 네트워크로의 직접적인 접속이 어렵고, NAT 테이블 관리가 복잡하며, 특정 애플리케이션 (P2P, VoIP 등) 과의 호환성 문제가 발생할 수 있습니다. 하지만 **포트 포워딩(Port Forwarding)** 기능을 통해 특정 포트에 대한 외부 접속을 내부 특정 장치로 연결할 수 있습니다. 포트 포워딩은 특정 서비스를 외부에서 접근 가능하도록 설정하는 데 유용하게 사용됩니다.

### 4.3.4. NAT 유형 비교 표

| 유형 | 매핑 방식 | 특징 | 장점 | 단점 | 사용 시나리오 |
| --- | --- | --- | --- | --- | --- |
| Static NAT | 1:1 고정 | 사설 IP - 공인 IP 고정 매핑 | 외부에서 내부 서버로 지속적인 접근 가능 | 공인 IP 주소 낭비, 동적 할당 불가 | 웹 서버, 메일 서버 등 외부 접근 필요 서버 |
| Dynamic NAT | N:M 동적 | 공인 IP 주소 풀에서 동적 할당 | 공인 IP 주소 효율적 사용 | 외부에서 내부 네트워크 직접 접속 불가, 동시 접속자 수 제한 | 기업 내부 직원 인터넷 접속 |
| PAT/NAPT | 1:N 포트 레벨 매핑 | 하나의 공인 IP 주소 다수 장치 공유, 포트 포워딩 지원 | 공인 IP 주소 매우 효율적 사용, IP 부족 문제 해결에 효과적 | 외부에서 내부 네트워크 직접 접속 불가, NAT 테이블 관리 복잡, 특정 앱 호환성 문제 | 가정용 공유기, 소규모 사무실 인터넷 공유 |

### 4.4. NAT 장단점 및 한계점

### 4.4.1. NAT 장점

- **공인 IP 주소 절약:** 하나의 공인 IP 주소를 여러 개의 사설 IP 주소가 공유하여 공인 IP 주소 부족 문제를 완화합니다.
- **내부 네트워크 보안 강화:** 내부 네트워크 구조를 숨기고 외부로부터의 직접적인 접근을 차단하여 기본적인 방화벽 기능과 보안 강화 효과를 제공합니다.
- **네트워크 구성 유연성 증대:** 사설 IP 주소 체계를 자유롭게 사용할 수 있어 네트워크 구성의 유연성을 높이고, IP 주소 변경 없이 ISP를 변경하는 등의 네트워크 환경 변화에 유연하게 대처할 수 있습니다.

### 4.4.2. NAT 단점 및 한계점

- **성능 저하 가능성:** NAT 장비는 주소 변환 작업을 수행해야 하므로 네트워크 성능 저하를 야기할 수 있습니다. 특히 PAT/NAPT는 포트 번호까지 변환하므로 성능 저하가 더 클 수 있습니다. 하지만 최근 NAT 장비의 성능 향상으로 인해 성능 저하 문제는 많이 완화되었습니다.
- **연결 추적의 어려움:** NAT 환경에서는 외부에서 내부 네트워크로의 연결을 추적하기 어렵습니다. NAT 테이블을 통해 연결 정보를 관리하지만, NAT 테이블 정보는 일정 시간이 지나면 삭제되므로 과거 연결 기록을 추적하기 어려울 수 있습니다.
- **특정 애플리케이션 호환성 문제 (NAT traversal 필요):** 일부 애플리케이션 (P2P, VoIP, 온라인 게임 등) 은 NAT 환경에서 정상적으로 동작하지 않거나, 복잡한 NAT traversal 기술을 필요로 할 수 있습니다. NAT traversal 기술은 NAT 환경에서 P2P 통신이나 VoIP 통신을 가능하게 하는 기술이지만, 완벽한 해결책은 아닙니다.

### 4.5. NAT와 보안

### 4.5.1. 기본적인 방화벽 기능 제공 및 보안 강화 효과

NAT는 내부 네트워크를 외부로부터 보호하는 기본적인 방화벽 기능을 제공합니다. NAT는 외부에서 내부 네트워크로의 연결을 기본적으로 차단하며, 내부에서 외부로의 연결만 허용합니다. 따라서 외부 공격자가 내부 네트워크의 장치에 직접 접근하는 것을 막을 수 있습니다. 하지만 NAT는 완벽한 방화벽 솔루션은 아니며, 보다 강력한 보안을 위해서는 방화벽, 침입 탐지 시스템(IDS), 침입 방지 시스템(IPS) 등과 같은 보안 장비 및 기술을 함께 사용하는 것이 필요합니다.

### 4.5.2. NAT traversal 기술 소개

NAT traversal 기술은 NAT 환경에서 P2P 통신, VoIP, 온라인 게임 등 특정 애플리케이션이 정상적으로 동작하도록 하는 기술입니다. NAT 환경에서는 외부에서 내부 네트워크로 직접 연결하는 것이 어렵기 때문에 P2P 통신이나 VoIP 통신과 같이 양방향 통신이 필요한 애플리케이션은 NAT 환경에서 제대로 동작하지 않을 수 있습니다. NAT traversal 기술은 다양한 방식으로 구현될 수 있으며, STUN, TURN, ICE 등이 대표적인 NAT traversal 프로토콜입니다. NAT traversal 기술을 통해 NAT 환경에서도 특정 애플리케이션을 사용할 수 있지만, 기술적인 복잡성과 성능 저하 문제가 발생할 수 있습니다.