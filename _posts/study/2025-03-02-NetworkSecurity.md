---
title: 네트워크 보안(방화벽, IDS/IPS, WAF)
date: 2025-03-02 00:11:00 +09:00
categories: [common_topic]
tags: [common]
# image: 
#   path:
---

## 1. 서론

### 1.1. 위협 환경의 변화

- 인터넷 초창기에는 기업 내 **폐쇄형 네트워크**와 외부 **오픈 네트워크** 사이에 명확한 경계가 존재했음
- 하지만 모바일 기기, 클라우드 서비스, 재택근무, BYOD(Bring Your Own Device), IoT 디바이스까지 등장하며, **네트워크 경계**가 급격히 확장되고 모호해짐
- 랜섬웨어, APT(Advanced Persistent Threat), 제로데이(Zero-Day) 등 **지능형 공격**이 증가하면서 전통적인 경계 보안만으로는 충분하지 않게 됨

### 1.2. 경계 보안에서 다층 보안으로

- 과거에는 **경계(Perimeter) 보안 모델**을 통해 외부 위협을 차단하는 것이 일반적이었음
- 오늘날에는 내부망도 더 이상 신뢰할 수 없으며, **Zero Trust** 모델과 **다층 방어(Defense in Depth)**가 중요
- **방화벽(Firewall)**, **IDS/IPS**, **WAF**는 네트워크 계층부터 애플리케이션 계층까지 **상호 보완적** 역할을 수행하며, 통합적 접근이 필요

---

## 2. 핵심 보안 장비 및 OSI 계층 관점

아래 표는 대표적인 네트워크 보안 장비 3종(방화벽, IDS/IPS, WAF)을 **OSI 계층**과 **주요 특징**에 따라 비교·정리한 것입니다.

| 구분 | **방화벽(Firewall)** | **IDS/IPS** | **WAF** |
| --- | --- | --- | --- |
| **주요 OSI 계층** | L3~L4 (전통적)L7 (차세대 방화벽: 애플리케이션 인식) | L3~~L7 (네트워크 기반 IDS/IPS: L3~~L4, 호스트 기반 HIDS: L7 포함) | L7 (HTTP/HTTPS) |
| **주요 목적** | 네트워크 경계에서 IP·포트·프로토콜 수준 트래픽 제어 | 알려진 혹은 이상 트래픽을 탐지(IDS) 혹은 실시간 차단(IPS) | 웹 애플리케이션 계층(SQLi, XSS 등) 특화 공격 차단 |
| **주요 탐지 기법** | ACL(Access Control List)상태 기반(Stateful) 검사DPI(차세대 방화벽) | 시그니처 기반(룰셋), 이상 탐지(통계, ML), 하이브리드 | 시그니처(정규식, 패턴)OWASP Top 10 공격룰화이트리스트/블랙리스트 혼합 |
| **배치 형태** | 네트워크 경계(예: DMZ 구간) 혹은 내부 세그먼트 경계 | - NIDS: 스위치 Span/TAP (Out-of-Band)- IPS: 인라인(In-Line) 네트워크 구간에 배치 | - Reverse Proxy 형태로 웹 서버 앞단에 배치- L7 Load Balancer와 연동 가능 |
| **장점** | - 고성능, 기본 네트워크 공격 필터링- L3~4 수준 트래픽 제어의 핵심 | - 실시간 공격 탐지(IDS)·차단(IPS)- 시그니처 업데이트로 다양한 공격 대응 | - HTTP/HTTPS 트래픽에 대한 정밀 검사- SSL 오프로딩 후 애플리케이션 레벨 필터링 가능 |
| **한계/주의사항** | - 애플리케이션 레벨의 복잡한 공격 방어에 제한 (전통적 방화벽 기준)- 정책 관리 복잡 | - 오탐/미탐 관리 필요- 인라인(IPS) 시 네트워크 성능 영향 | - HTTPS 복호화 시 자원 부담- 웹 외 네트워크 공격은 직접 방어 불가 |

---

## 3. 방화벽(Firewall) 심층 분석

### 3.1. 패킷 필터링(Packet Filtering) 방식

- **OSI 3~4계층**의 IP 주소, 포트 번호, 프로토콜(UDP/TCP 등) 정보를 기반으로 접근을 허용하거나 차단
- 룰셋(ACL: Access Control List)에 따라 소스/목적지 IP, 사용 포트, 프로토콜을 필터링
- 구현이 간단하고 고속 처리가 가능하지만, **애플리케이션 계층**의 세부 공격은 식별하기 어려움

### 3.2. 상태 기반 검사(Stateful Inspection)

- TCP 세션의 3-Way Handshake 등을 추적하여, **연결 상태**가 정상적으로 유지되는지 검사
- 세션 테이블을 유지하며, 트래픽 흐름이 비정상적인 경우(세션 없이 갑자기 들어온 패킷 등) 차단
- 세션 정보를 추적하기 때문에 메모리 사용량이 증가할 수 있으며, 룰셋 구성도 복잡해짐

### 3.3. 애플리케이션 게이트웨이(Proxy Firewall)

- 방화벽이 **중간자 역할**을 하여 클라이언트와 서버 간 트래픽을 대리
- **OSI 7계층**까지 분석 가능하므로, 특정 애플리케이션 프로토콜(예: HTTP, SMTP 등)의 콘텐츠 검사 가능
- 트래픽을 모두 재전달해야 하므로 **성능 부담**이 크고, 프록시를 지원하지 않는 프로토콜에는 적용이 제한적

### 3.4. 차세대 방화벽(NGFW, Next-Generation Firewall)

- 전통적인 패킷 필터·상태 기반 검사를 넘어, **애플리케이션 식별**, 사용자 식별, SSL 검사 등 **DPI(Deep Packet Inspection)**를 수행
- UTM(Unified Threat Management) 기능으로 **IPS, 웹 필터링, VPN** 등을 통합 운영 가능
- 단일 장비 내 다기능을 통합함에 따라 **정교한 정책 설정**과 **고성능 하드웨어**가 요구됨

---

## 4. 침입 탐지/방지 시스템(IDS/IPS) 심층 분석

### 4.1. 트래픽 수집/배치 방법

1. **NIDS(Network-based IDS)**
    - 스위치의 Span 포트나 네트워크 TAP을 통해 트래픽을 **복제**하여 Out-of-Band 방식으로 분석
    - 실제 트래픽 경로에 영향을 주지 않으므로 **네트워크 성능**에 직접적 부담이 적음
    - 단, **실시간 차단**은 어려워 주로 탐지(IDS) 용도로 사용
2. **IPS(Intrusion Prevention System)**
    - 물리적으로 네트워크 인라인(In-Line)에 배치되어, 트래픽이 **장비를 거쳐가도록** 구성
    - 악성 트래픽을 식별하면 바로 차단 가능
    - 인라인 특성상 장비 성능이 충분히 뒷받침되지 않으면 병목이 될 수 있음
3. **HIDS(Host-based IDS)**
    - 호스트(서버)에 에이전트를 설치해 로그, 프로세스, 파일 접근 등을 모니터링
    - 네트워크 트래픽이 아닌 **호스트 내부 행위**(권한 상승, 악성 프로세스 실행 등)까지 감시 가능
    - 서버 리소스 점유, 운영체제 의존성 등을 고려해야 함

### 4.2. 시그니처 기반 탐지

- **공격 패턴**(Signature)을 룰셋 형태로 관리하며, 패킷 또는 세션 데이터를 매칭
- 예) Snort 룰: `alert tcp any any -> 192.168.0.0/24 80 (msg:"SQL Injection attempt"; content:"UNION SELECT"; ...)`
- 알려진 공격에는 정확도가 높으나, **변종 공격**이나 **제로데이**에는 대응이 늦어질 수 있음

### 4.3. 이상 탐지(Anomaly-based) 기법

- 정상 트래픽(베이스라인)을 학습하고, 통계적·머신러닝 기법으로 **평균에서 벗어난 행위**를 공격으로 간주
- 알려지지 않은 **신종 공격**에도 대응 가능하지만, **오탐**이 많을 수 있어 지속적 튜닝이 필요
- 최근에는 AI/ML 기반의 **UEBA(User and Entity Behavior Analytics)**가 발전 중

### 4.4. 하이브리드 접근

- **시그니처 기반** + **이상 탐지**를 병행하여, 알려진 공격과 신종 공격을 모두 포괄
- 시그니처는 오탐률이 낮은 반면, 이상 탐지는 사각지대를 줄이는 효과가 있음
- 보안 관제 환경에서는 하이브리드 방식으로 이벤트 **등급화**를 수행해, 관리 효율을 높임

---

## 5. 웹 애플리케이션 방화벽(WAF) 심층 분석

### 5.1. HTTP/HTTPS 트래픽 분석 원리

- **Reverse Proxy** 형태로 웹 서버 앞단에 위치하여, 모든 HTTP/HTTPS 요청을 먼저 수신
- HTTPS의 경우, WAF가 **SSL/TLS 복호화**를 수행(SSL Offloading)하여 **평문 상태의 HTTP**를 검사
- URL, HTTP 메서드, 파라미터, 헤더, 쿠키, 바디 등에 숨겨진 공격 패턴을 식별

### 5.2. 대표적인 웹 공격 유형

1. **SQL Injection**
    - 데이터베이스 쿼리를 삽입하여 **인증 우회**, DB 조회·수정 등 비정상적 동작 유도
    - 예: `SELECT * FROM users WHERE id='1' OR '1'='1';`
2. **XSS(Cross-Site Scripting)**
    - 웹 페이지에 악성 스크립트를 삽입하여, **클라이언트(사용자 브라우저)** 측 정보 탈취 혹은 세션 하이재킹
    - 예: `<script>alert('XSS');</script>`
3. **CSRF(Cross-Site Request Forgery)**
    - 사용자가 의도치 않은 요청을 특정 사이트로 전송하여 **권한이 있는 사용자**를 악용
    - 예: 사용자 브라우저의 쿠키·세션 정보를 악의적 스크립트가 이용
4. **File Inclusion / Directory Traversal**
    - 서버의 파일 경로를 조작하여 민감 정보(예: `/etc/passwd`)를 열람
    - PHP `include()`, `require()` 함수 등에 파라미터 조작을 통해 악성 코드 포함

### 5.3. 룰셋 적용 및 시그니처 분석

- **블랙리스트(Negative Security Model)**: 알려진 공격 패턴을 모두 차단
- **화이트리스트(Positive Security Model)**: 정상 요청 형태만 허용하고, 나머지는 차단
- **OWASP CRS(Core Rule Set)**: 오픈소스 기반의 웹 공격 시그니처 모음집, ModSecurity 등과 연동

### 5.4. 성능 및 운영상의 이슈

- WAF가 SSL 복호화를 수행하므로, 트래픽이 많을수록 **CPU 부담**이 커짐
- **오탐** 발생 시 정상 사용자의 HTTP 요청이 차단될 위험 → 룰셋 튜닝 및 예외 설정 필요
- 고가용성과 부하 분산(Load Balancing)을 고려해 **여러 대의 WAF**를 병렬 운영하는 사례도 존재

---

## 6. 다층 방어 관점에서의 통합 운영

### 6.1. 상호 보완적 역할

- **방화벽(Firewall)**: IP/포트/프로토콜 단에서 트래픽을 필터링해 기본적인 접근 제어 수행
- **IDS/IPS**: 방화벽을 통과한 트래픽 중 **이상·악성 행위**를 추가적으로 탐지하고 실시간 차단
- **WAF**: 웹 애플리케이션 특화 공격(SQLi, XSS 등)을 더욱 정교하게 차단

### 6.2. SIEM 연동 및 통합 로그 분석

- 각 장비에서 발생하는 **이벤트 로그**를 **SIEM(Security Information and Event Management)**에 수집
- 네트워크 계층(방화벽/IDS/IPS)과 애플리케이션 계층(WAF)의 로그를 **상관 분석**하여 공격 흐름 파악
- 실시간 경보(Alert) 모니터링 및 **침해사고(Incident) 대응**에 활용

### 6.3. 내부 세그먼테이션 및 NAC

- 최근 **Zero Trust** 환경에서는 내부망이라도 세분화가 중요
- **네트워크 접근 제어(NAC)**, 마이크로세그먼테이션 등을 통해 내부 사용자의 권한과 디바이스 상태를 지속 검증
- 방화벽, IDS/IPS, WAF 외에도 NAC, EDR, IAM 등을 연동한 **통합 보안 아키텍처**가 요구됨

---

## 7. 확장된 네트워크 보안 기술과 트렌드

### 7.1. Zero Trust & 지속 검증

- 전통적인 경계 보안을 탈피하여, **모든 트래픽**(내·외부 불문)을 끊임없이 검증
- 사용자·디바이스·애플리케이션 각각의 **신뢰 상태**를 실시간으로 평가(멀티 팩터 인증, 정책 기반 접근)

### 7.2. 클라우드 네이티브 보안

- **AWS, Azure, GCP** 등 퍼블릭 클라우드 환경에서 Security Group, VPC Firewall, WAF, IDS/IPS(가상 어플라이언스) 등을 활용
- **Kubernetes** 기반 컨테이너 환경에서, **네트워크 폴리시**(CNI)와 **사이드카 프록시**(서비스 메쉬)로 L7 트래픽 필터링
- 인프라를 코드(IaC)로 관리함에 따라, 보안 설정도 **CI/CD 파이프라인**에 포함(DevSecOps)

### 7.3. AI/머신러닝 기반 보안

- 보안 이벤트 로그가 폭증함에 따라, **UEBA(User and Entity Behavior Analytics)**, 머신러닝 기반 이상 탐지 도입
- **제로데이** 공격, **APT** 탐지를 위해 머신러닝 모델이 비정상 행위를 조기 식별
- 오탐 감소와 모델 정확도 향상을 위한 **데이터 품질** 및 **엔지니어링 노하우**가 중요

### 7.4. 고성능 및 암호화 트래픽 대응

- TLS 1.3 등 암호화 프로토콜이 보편화되면서, **암호화 트래픽 분석**(SSL Inspection)의 비중이 크게 증가
- 방화벽/IPS/WAF 모두 SSL 복호화 과정에서 높은 자원 소모 → **전용 하드웨어 가속기**(암호화 칩) 탑재가 대세

---

## 8. 최적의 보안 운영을 위한 전략

### 8.1. 정책(룰셋) 관리 및 지속 업데이트

- 시그니처 DB, 룰셋(방화벽 ACL, IDS 규칙, WAF 룰) 등을 **주기적으로 갱신**
- 사용하지 않는 규칙(Orphan Rule), 중복된 규칙 등을 점검하여 **정리**하고 **최적화**

### 8.2. 성능 모니터링 및 용량 계획

- 방화벽, IPS, WAF 장비 모두 고성능이 요구되는 구간(예: 대규모 인터넷 관문)에 배치되는 경우가 많음
- **패킷 처리량(PPS, Packet Per Second), SSL 처리량** 등을 감안해 **스케일 아웃(병렬 확장)** 혹은 스케일 업(장비 성능 확대) 전략 활용

### 8.3. 로그 관리 및 침해사고 대응(IR)

- **SIEM**이나 **로그 분석 플랫폼**을 구축하여, 이벤트를 상관분석하고 이상 징후를 조기에 파악
- **인시던트 발생 시**에는 장비 로그를 통해 공격 시나리오 추적, 포렌식 분석
- **침투 테스트(Penetration Test)**, Red/Blue Team 훈련 등을 통해 **실효성** 재점검

### 8.4. 정기 취약점 스캐닝 및 보안 감사

- **네트워크 및 웹 취약점**에 대한 정기적인 스캐닝(자동화 툴, 모의해킹) 실시
- 방화벽 규칙 검증, IDS/IPS 시그니처 정확도, WAF 룰셋 적용 상황을 **분기·반기 단위**로 감사
- **ISMS-P, ISO27001**, 기타 산업 규제(금융, 의료 등) 준수 여부도 체크

---

## 9. 결론 및 향후 전망

### 9.1. 방화벽·IDS/IPS·WAF의 상호 보완성

- 방화벽(Firewall)은 **네트워크 계층** 기반 접근 제어의 근간
- IDS/IPS는 **이상 행위 탐지** 및 **실시간 차단**을 통해 방화벽을 통과한 악성 트래픽을 추가 필터링
- WAF는 **웹 애플리케이션**에 특화된 공격(SQLi, XSS 등)까지 심층 방어
- 세 장비가 서로의 장단점을 보완하며, **다층 방어(Defense in Depth)** 체계를 구축하는 핵심 요소

### 9.2. Zero Trust 시대의 지속 진화

- **Zero Trust**, **클라우드 네이티브**, **AI/ML 기반 보안** 등이 부상하면서, 경계 기반 보안이 세분화되고 고도화되는 추세
- 기존 장비들 역시 **SSL Inspection**, **머신러닝 기반 이상 탐지**, **자동화된 정책 배포** 등 기능을 계속 확장

### 9.3. 요약 및 제언

1. **방화벽**: 네트워크 레벨 접근 통제의 중심축
2. **IDS/IPS**: 서명 기반 + 이상 탐지를 통한 신종 공격 방어
3. **WAF**: 웹 계층 공격 특화 방어 장치
4. **통합 관제(SIEM)**: 서로 다른 보안 장비에서 생성되는 이벤트를 중앙에서 연계 분석
5. **정기적 점검**과 **정책 최적화**: 보안 환경은 늘 변화하므로, 업그레이드·튜닝이 필수

> 결국, 방화벽-IDS/IPS-WAF의 조합은 과거부터 현재까지 네트워크 및 애플리케이션 보안의 핵심 축을 담당해 왔으며, 앞으로도 보안 위협이 진화함에 따라 해당 장비들 역시 AI·클라우드·Zero Trust 트렌드에 맞추어 지속적으로 발전해갈 것입니다.
> 

---